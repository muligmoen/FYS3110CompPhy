\documentclass[11pt,a4paper,english]{article}
\usepackage[english]{babel} % Using babel for norwegian hyphenation
\usepackage{lmodern} % Changing the font
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}

%\usepackage[moderate]{savetrees} % [subtle/moderate/extreme] really compact writing
\usepackage{tcolorbox}
\usepackage[parfill]{parskip} % Removes indents
\usepackage{amsmath} % Environment, symbols etc...
\usepackage{amssymb}
\usepackage{float} % Fixing figure locations
\usepackage{multirow} % For nice tables
%\usepackage{wasysym} % Astrological symbols
\usepackage{graphicx} % For pictures etc...
\usepackage{enumitem} % Points/lists
%\usepackage{physics} % Typesetting of mathematical physics examples: \bra{}, \ket{}, expval{}
\usepackage{url}

\definecolor{red}{RGB}{255,10,10}

% To include code(-snippets) with æøå
\usepackage{listings}
\lstset{
language=c++,
showspaces=false,
showstringspaces=false,
frame=l,
}

\tolerance = 5000 % Bedre tekst
\hbadness = \tolerance
\pretolerance = 2000

\numberwithin{equation}{section}

\newcommand{\conj}[1]{#1^*}
\newcommand{\ve}[1]{\mathbf{#1}} % Vektorer i bold
\let\oldhat\hat
\renewcommand{\hat}[1]{\mathbf{\oldhat{#1}}}
\newcommand{\trans}[1]{#1^\top}
\newcommand{\herm}[1]{#1^\dagger}
%\renewcommand{\thefootnote}{\fnsymbol{footnote}} % Gir fotnote-symboler
\newcommand{\Real}{\mathbb{R}}
\newcommand{\bigO}[1]{\mathcal{O}\left( #1 \right)}

\newcommand{\spac}{\hspace{5mm}}

\title{FYS3150/4150\\Computational Physics\\Project 2}
\author{Magnus Ulimoen\\Krister Stræte Karlsen}
\date{\today}

\begin{document}
\maketitle

\section{Introduction}

In this projct the Schr\"odinger's equation for two electrons in a three-dimensional harmonic oscillator well will be solved numerically. Both computational and physical aspects of the problem will be discussed throughout the report. 


\section{Method}

\subsection{Mathematical formulation and scaling}

We will assume spherical symmetry and that the electrons move in a three-dimensional harmonic
oscillator potential and repel  each other via the static Colulomb interaction.  

The radial part of the Schr\"odinger's equation for one electron then reads:
\[
  -\frac{\hbar^2}{2 m} \left ( \frac{1}{r^2} \frac{d}{dr} r^2
  \frac{d}{dr} - \frac{l (l + 1)}{r^2} \right )R(r) 
     + V(r) R(r) = E R(r).
\]
In our case $V(r)$ is the harmonic oscillator potential $(1/2)kr^2$ with
$k=m\omega^2$ and $E$ is
the energy of the harmonic oscillator in three dimensions.
The oscillator frequency is $\omega$ and the energies are
\[
E_{nl}=  \hbar \omega \left(2n+l+\frac{3}{2}\right),
\]
with $n=0,1,2,\dots$ and $l=0,1,2,\dots$.
 
Using spherical coordinates we have $r\in [0,\infty)$. The quantum number
$l$ is the orbital momentum of the electron.
Then we make the substitution $R(r) = (1/r) u(r)$ and obtain

\[
  -\frac{\hbar^2}{2 m} \frac{d^2}{dr^2} u(r) 
       + \left ( V(r) + \frac{l (l + 1)}{r^2}\frac{\hbar^2}{2 m}
                                    \right ) u(r)  = E u(r) .
\]
%
The boundary conditions are $u(0)=0$ and $u(\infty)=0$.

Introducing the dimensionless variable $\rho = (1/\alpha) r$
where $\alpha$ is a constant with dimension length we get
% 
\[
  -\frac{\hbar^2}{2 m \alpha^2} \frac{d^2}{d\rho^2} u(\rho) 
       + \left ( V(\rho) + \frac{l (l + 1)}{\rho^2}
         \frac{\hbar^2}{2 m\alpha^2} \right ) u(\rho)  = E u(\rho) .
\]
%
In this project we will only study the situation $l=0$.
Inserting $V(\rho) = (1/2) k \alpha^2\rho^2$ we end up with
\[
  -\frac{\hbar^2}{2 m \alpha^2} \frac{d^2}{d\rho^2} u(\rho) 
       + \frac{k}{2} \alpha^2\rho^2u(\rho)  = E u(\rho) .
\]
Multiplying with $2m\alpha^2/\hbar^2$ on both sides to obtain
\[
  -\frac{d^2}{d\rho^2} u(\rho) 
       + \frac{mk}{\hbar^2} \alpha^4\rho^2u(\rho)  = \frac{2m\alpha^2}{\hbar^2}E u(\rho) .
\]
The constant $\alpha$ can now be fixed such that
\[
\frac{mk}{\hbar^2} \alpha^4 = 1,
\]
or 
\[
\alpha = \left(\frac{\hbar^2}{mk}\right)^{1/4}.
\]
Defining 
\[
\lambda = \frac{2m\alpha^2}{\hbar^2}E,
\]
we can rewrite Schr\"odinger's equation as
\[
  -\frac{d^2}{d\rho^2} u(\rho) + \rho^2u(\rho)  = \lambda u(\rho) .
\]

This equation can now be discretized and solved as a linear system using Jacobi's algorithm for eigenvalues. 
 
\subsection{Jacobi's eigenvalue algorithm}

\textcolor{red}{KSK: These are straight up answers to a). A more complete subsection should be made.}

Having defined the quantities $\tan\theta = t= s/c$, with $s=\sin\theta$ and $c=\cos\theta$ and
\[\cot 2\theta=\tau = \frac{a_{ll}-a_{kk}}{2a_{kl}}.
\]

We can then define the angle $\theta$ so that the non-diagonal matrix elements of the transformed matrix 
$a_{kl}$ become non-zero and
we obtain the quadratic equation (using $\cot 2\theta=1/2(\cot \theta-\tan\theta)$
\[
t^2+2\tau t-1= 0,
\]
resulting in 
\[
  t = -\tau \pm \sqrt{1+\tau^2},
\]

Here a clever choice of roots must be made. For for a well trained computational physisist this equation should be a red warning sign of loss of numerical precision. To avoid subtraction of to almost equal numbers the following chioice should be made:

\begin{align*}
t=  -\tau + \sqrt{1+\tau^2}, \quad   0  \geq \tau \\
t=  -\tau - \sqrt{1+\tau^2}, \quad   \tau <  0
\end{align*}

This choice also makes sure $t$ is the smaller of the roots. From the equations above we obtain the folowing relation for $c$ and $t$
\[
   c = \frac{1}{\sqrt{1+t^2}}.
\]
Knowing that $t \in [0,1]$ we put restrictions such that $c \in [\frac{1}{\sqrt{2}}, 1]$ which focres $\theta$ to be in the interval $[- \frac{\pi}{4},\frac{\pi}{4}]$.  

This has the following effect on the convergence.. 

\subsubsection{Implementation}

\centerline{Algorithm I}
\begin{tcolorbox}
Find the largest element, $a_{k,l}$, in $A$ \\
Compute $\tau:$ \\
$ \tau = \frac{a_{ll}-a_{kk}}{2a_{kl}}$ \\
Compute t according to:  \\
$t=  -\tau + \sqrt{1+\tau^2}, \quad   0  \geq \tau \\
t=  -\tau - \sqrt{1+\tau^2}, \quad   \tau <  0 $ \\
Set \\
$ c= \frac{1}{\sqrt{1+t^2}}, \quad s= ct$ \\
Compute the new matrix elements: \\
$ b_{kl} = a_{kl}, \quad k,l \neq i,j$ \\
$ b_{ik} = b_{ki} = ca_{ik}-sa_{jk}, \quad k \neq i,j$ \\
$ b_{jk} = b_{kj} = sa_{ik}+ca_{jk}, \quad k \neq i,j$ \\
$ b_{ij} = b_{ji} = (c^2 - s^2)a_{ij} + cs(a_{ii}-a_{jj}) $ \\
$ b_{ii} = c^2 a_{ii} - 2csa_{ij} + s^2 a_{jj} $ \\
$ b_{jj} = s^2 a_{ii} + 2csa_{ij} + c^2 a_{jj} $ \\

\end{tcolorbox} 

\subsubsection{Unit tests}


\section{Results and reflection}

\section{Concluding remarks }

\end{document}
